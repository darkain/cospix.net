<?php

$user->requireAccessStaff('event', $event);

require_once('../event.php.inc');




////////////////////////////////////////////////////////////////////////////////
//PULL SELECTED ROOM
////////////////////////////////////////////////////////////////////////////////
$room = $db->rowId('pudl_schedule_room', 'schedule_room_id', $get->id());




////////////////////////////////////////////////////////////////////////////////
//UPDATE DATA
////////////////////////////////////////////////////////////////////////////////
$data = [
	'schedule_room_name'		=> $get('name'),
	'schedule_room_increment'	=> $get('increment'),
	'schedule_room_text'		=> $get('text'),
];




////////////////////////////////////////////////////////////////////////////////
//INSERT OR UPDATE THE DATA
////////////////////////////////////////////////////////////////////////////////
if (empty($room)) {
	$_POST['id'] = $_GET['id'] = $db->insert('pudl_schedule_room', $data+[
		'event_id' => $event['event_id'],
	]);
} else {
	\af\affirm(422, $room['event_id'] === $event['event_id']);
	$db->updateId('pudl_schedule_room', $data, 'schedule_room_id', $get->id());
}




////////////////////////////////////////////////////////////////////////////////
//SWITCH BACK TO RENDERING MODE
////////////////////////////////////////////////////////////////////////////////
require('rooms.php');
