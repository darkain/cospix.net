<?php




////////////////////////////////////////////////////////////////////////////////
//PULL THE ACCOUNT INFORMATION
////////////////////////////////////////////////////////////////////////////////
$account = $db->rowId('pudl_user_auth', 'auth_account', $get);
if (empty($account)) return 'Account not found';
$account = new afUser($db, $account);




////////////////////////////////////////////////////////////////////////////////
//GENERATE AND UPDATE THE ACCOUNT PASSWORD
////////////////////////////////////////////////////////////////////////////////
$password = afString::password();
$account->setPassword($get('auth_account'), $password);




////////////////////////////////////////////////////////////////////////////////
//SEND AN EMAIL TO THE ADDRESS PROVIDED
////////////////////////////////////////////////////////////////////////////////
$af->load('reset.tpl');

$af->field('password', $password);

\af\mail([
	'reply'	=>  $afconfig->email,
	'from'	=> [$afconfig->email, $og['title']],
	'to'	=>  $get('auth_account'),
], $og['title'].' New Password', $af->renderToString());




////////////////////////////////////////////////////////////////////////////////
//RENDER FINAL OUTPUT
////////////////////////////////////////////////////////////////////////////////
$af->renderPage('finished.tpl');
return true;
