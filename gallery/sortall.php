<?php

////////////////////////////////////////////////////////////////////////////////
//ONLY LOGGED IN USERS
////////////////////////////////////////////////////////////////////////////////
$user->requireLogin();




////////////////////////////////////////////////////////////////////////////////
//TRANSACTIONS
////////////////////////////////////////////////////////////////////////////////
$db->begin();




////////////////////////////////////////////////////////////////////////////////
//SORT A USER PROFILE GALLERIES
////////////////////////////////////////////////////////////////////////////////
if ($af->prometheus()) {
	$items = $get->intArray('cpn_gallery');
} else {
	$items = $get->intArray('gallery-item');
}

foreach ($items as $key => $item) {
	$db->update('pudl_gallery', [
		'gallery_sort'	=> ((int)$key)+1,
	], [
		'gallery_id'	=> $item,
		'user_id'		=> $user->user_id,
	]);
}




////////////////////////////////////////////////////////////////////////////////
//TRANSACTIONS
////////////////////////////////////////////////////////////////////////////////
$db->commit();




////////////////////////////////////////////////////////////////////////////////
//CONFIRMATION BACK TO CLIENT
////////////////////////////////////////////////////////////////////////////////
$af->ok();
