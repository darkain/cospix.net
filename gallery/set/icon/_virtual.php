<?php
$user->requireLogin();




////////////////////////////////////////////////////////////////////////////////
//PULL GALLERY INFORMATION
////////////////////////////////////////////////////////////////////////////////
$gallery = $db->rowId('pudl_gallery', 'gallery_id', $router->id);
\af\affirm(404, $gallery);
\af\affirm(401, $user->is($gallery));




////////////////////////////////////////////////////////////////////////////////
//PROCESS INCOMING FILE
////////////////////////////////////////////////////////////////////////////////
$import	= new \af\import($af, $db);
$file	= $import->upload();




////////////////////////////////////////////////////////////////////////////////
//UPDATE GALLERY ICON
////////////////////////////////////////////////////////////////////////////////
$db->updateId('pudl_gallery', [
	'gallery_thumb' => $file['file_hash']
], 'gallery_id', $gallery);




////////////////////////////////////////////////////////////////////////////////
//OUTPUT
////////////////////////////////////////////////////////////////////////////////
$af->json($file);
